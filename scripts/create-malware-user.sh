#!/bin/bash

if [[ "$#" -ne 2 ]]; then
  echo "You must enter exactly 2 command line arguments"
  echo "specify --host-user or --docker-user"
  exit
elif [[ "$1" == "--host-user" ]]; then
  ACCOUNT_NAME=$2-host
elif [[ "$1" == "--docker-user" ]]; then
  ACCOUNT_NAME=$2-docker
  ADD_TO_DOCKER_GROUP=true
fi

echo "creating user account ${ACCOUNT_NAME}"
adduser --disabled-password --gecos " " ${ACCOUNT_NAME}
if [[ ${ADD_TO_DOCKER_GROUP} == true ]]; then
  echo "adding user account ${ACCOUNT_NAME} to docker group"
  adduser ${ACCOUNT_NAME} docker
fi
passwd --delete ${ACCOUNT_NAME}
